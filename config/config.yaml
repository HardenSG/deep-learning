# A股量化深度学习系统配置文件

# 数据配置
data:
  raw_data_path: "data/raw"
  processed_data_path: "data/processed"
  database_path: "data/stock_data.db"
  
  # 股票列表 (示例，可扩展)
  stock_list:
    - "000001"  # 平安银行
    - "600519"  # 贵州茅台
    - "000858"  # 五粮液
    - "600036"  # 招商银行
    - "601318"  # 中国平安
  
  # 数据更新配置
  update_schedule:
    enabled: true
    time: "15:30"  # 每天15:30更新
  
  # 历史数据范围
  start_date: "2020-01-01"
  end_date: null  # null表示当前日期

# 特征工程配置
features:
  # 时间窗口
  window_size: 5  # 使用过去5天的数据 (滑动窗口优化：3-5天)

  # 技术指标参数
  technical_indicators:
    ma_periods: [5, 10, 20, 30, 60]
    ema_periods: [12, 26]
    rsi_period: 14
    macd_fast: 12
    macd_slow: 26
    macd_signal: 9
    kdj_period: 9
    bollinger_period: 20
    bollinger_std: 2
    atr_period: 14

  # 特征标准化
  normalization: "minmax"  # minmax 或 standard

  # 是否使用平稳特征 (去除非平稳的价格数据，仅保留收益率和差分)
  use_stationary: true

  # ============ 多因子配置 ============
  # 是否启用多因子（资金流向、北向资金、舆情、宏观）
  use_multi_factors: true

  multi_factors:
    # 资金流向因子
    fund_flow:
      enabled: true
      features:
        - main_net_inflow       # 主力净流入
        - main_net_inflow_pct   # 主力净流入占比
        - super_large_net_inflow # 超大单净流入
        - large_net_inflow      # 大单净流入
        - medium_net_inflow     # 中单净流入
        - small_net_inflow      # 小单净流入(散户)

    # 北向资金因子
    north_flow:
      enabled: true
      features:
        - north_net_buy         # 北向资金净买入
        - north_flow_ma5        # 北向资金5日均值
        - north_flow_sum10      # 北向资金10日累计

    # 舆情情绪因子
    sentiment:
      enabled: true
      features:
        - sentiment_mean        # 新闻情绪均值
        - sentiment_std         # 新闻情绪波动
        - news_count            # 新闻数量(关注度)
      # 情绪分析关键词权重(可扩展)
      positive_words:
        - 涨停
        - 利好
        - 增长
        - 突破
        - 回购
      negative_words:
        - 跌停
        - 利空
        - 亏损
        - 减持
        - 风险

    # 宏观政策因子
    macro:
      enabled: true
      features:
        - lpr_1y                # 1年期LPR利率
        - lpr_5y                # 5年期LPR利率
        - cpi                   # CPI同比
        - m2_yoy                # M2同比增速
      # 宏观数据更新频率(月度数据需前向填充)
      fill_method: "ffill"

    # 衍生因子(自动计算)
    derived:
      enabled: true
      features:
        - main_flow_change      # 主力资金变化率
        - main_flow_ma5         # 主力资金5日均值
        - fund_flow_momentum    # 资金流向动量(主力-散户)
        - north_flow_change     # 北向资金变化率
        - sentiment_change      # 情绪变化
        - sentiment_ma5         # 情绪5日均值
        - fund_sentiment_score  # 资金情绪综合得分

# 模型配置
model:
  type: "LSTM"
  
  # LSTM参数
  lstm:
    input_size: null  # 自动计算
    hidden_size: 64  # 适配数值细节 (Doubao建议)
    num_layers: 1    # 回归任务不用深
    dropout: 0.1     # 低Dropout避免丢失细节
    bidirectional: false
  
  # 预测目标
  prediction:
    target: "value_diff"  # 预测数值差 (今日股价 - 昨日股价)
    horizon: 5  # 预测未来5天
  
  # 训练参数
  training:
    batch_size: 64  # 降低梯度噪声
    epochs: 100
    learning_rate: 0.0001  # 调小学习率，避免震荡
    weight_decay: 0.0001
    early_stopping_patience: 5  # 避免过拟合噪声
    validation_split: 0.2
    test_split: 0.1
    
  # 损失函数
  loss:
    type: "mse"  # 回归任务使用MSE
  model_save_path: "data/models"
  checkpoint_interval: 5

# API配置
api:
  host: "0.0.0.0"
  port: 8000
  debug: false
  workers: 4
  
  # CORS配置
  cors:
    enabled: true
    origins: ["*"]

# 日志配置
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_dir: "logs"
  log_file: "quant_system.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# 回测配置
backtest:
  initial_capital: 100000  # 初始资金10万
  commission_rate: 0.0003  # 手续费率0.03%
  slippage: 0.001  # 滑点0.1%
  
  # 交易策略
  strategy:
    buy_threshold: 0.02  # 预测收益率>2%时买入
    sell_threshold: -0.01  # 预测收益率<-1%时卖出
    max_position: 0.3  # 单只股票最大仓位30%

# 系统配置
system:
  random_seed: 42
  device: "cuda"  # cuda 或 cpu
  num_workers: 4
